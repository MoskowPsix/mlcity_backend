"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9145],{9145:(t,e,n)=>{n.r(e),n.d(e,{default:()=>rt});var o=n(6252);const a={key:0,class:"flex justify-center m-1"};var s=n(9305),r=n(3048),c=n(1257),l=n(4072);const d=(0,s.Q_)("useContent",{actions:{getContents:t=>(0,l.D)(c.Z.get("history-content",{params:t}))}});n(6110);var i=n(9233);const g=(0,s.Q_)("useHistoryContentsFilter",{state:()=>({contentName:new i.X(localStorage.getItem("contentNameFilter")||""),contentDate:new i.X(localStorage.getItem("contentDateFilter")||"~"),contentSponsor:new i.X(localStorage.getItem("contentSponsorFilter")||""),contentSearchText:new i.X(localStorage.getItem("contentTextFilter")||""),contentStatuses:new i.X(localStorage.getItem("contentStatusesFilter")||"1"),contentStatusLast:new i.X(localStorage.getItem("contentStatusLastFilter")||"true"),contentUser:new i.X(localStorage.getItem("contentUserFilter")||"")}),actions:{setContentName(t){localStorage.setItem("contentNameFilter",t),this.contentName=t},getContentName:()=>localStorage.getItem("contentNameFilter"),setContentDate(t){localStorage.setItem("contentDateFilter",t),this.contentDate=t},getContentDate(){return localStorage.getItem("contentDateFilter")||this.contentDate.getValue()},setContentSponsor(t){localStorage.setItem("contentSponsorFilter",t),this.contentSponsor=t},getContentSponsor:()=>localStorage.getItem("contentSponsorFilter"),setContentText(t){localStorage.setItem("contentTextFilter",t),this.contentSearchText=t},getContentText:()=>localStorage.getItem("contentTextFilter"),setContentStatuses(t){localStorage.setItem("contentStatusesFilter",t),this.contentStatuses=t},getContentStatuses:()=>localStorage.getItem("contentStatusesFilter"),setContentStatusLast(t){localStorage.setItem("contentStatusLastFilter",t),this.contentStatusLast=t,console.log(this.contentStatusLast)},getContentStatusLast:()=>localStorage.getItem("contentStatusLastFilter"),setContentUser(t){localStorage.setItem("contentUserFilter",t),this.contentUser=t},getContentUser:()=>localStorage.getItem("contentUserFilter")}}),u=(0,s.Q_)("useHistoryContentsQueryBuilder",{actions:{queryBuilder(t){return this.updateParams(),"contentsForPageContents"===t&&this.contentsForPageContents(),this.queryParams},updateParams(){this.name=g().getContentName(),this.date=g().getContentDate(),this.sponsor=g().getContentSponsor(),this.searchText=g().getContentText(),this.statuses=g().getContentStatuses(),this.statusLast=g().getContentStatusLast(),this.user=g().getContentUser()},contentsForPageContents(){let t=["",""];this.date&&(t=this.date.split("~")),this.queryParams={name:this.name,dateStart:t[0],dateEnd:t[1],sponsor:this.sponsor,searchText:this.searchText,statuses:this.statuses,statusesLast:this.statusLast,user:this.user,page:this.pageContentsForPageContent}},setPageContentsForPageContents(t){this.pageContentsForPageContent=t}},state:()=>({queryParams:[],name:null,date:null,sponsor:null,searchText:null,statuses:null,statusLast:null,user:null,pageContentsForPageContent:null})});var h=n(2876),p=n(368),m=n(3438),b=n(5709),x=n(486),f=n(1558),y=n(5244),k=n(1075),S=n(5631),C=n(5238);class w{static error_content="При загрузке контента на редактирование произошла ошибка";static warning_content="Неудачная загрузка конткнта на модерацию";static info_content="При загрузке записей на редактирование ничего не пришло"}var v=n(7935),_=n(3577);const D={class:"relative z-10 overflow-x-auto border border-gray-300 dark:border-gray-700 dark:border-gra rounded-lg"},P={class:"border border-gray-300 dark:border-gray-700 rounded-lg w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400"},F=(0,o._)("thead",{class:"border border-gray-300 dark:border-gray-700 rounded-lg text-xs text-gray-700 uppercase bg-gray-200 dark:bg-gray-800 dark:text-gray-400"},[(0,o._)("tr",null,[(0,o._)("th",{scope:"col",class:"px-6 py-3"}," id "),(0,o._)("th",{scope:"col",class:"px-6 py-3"}," Тип "),(0,o._)("th",{scope:"col",class:"px-6 py-3"}," Имя "),(0,o._)("th",{scope:"col",class:"px-6 py-3"}," Автор "),(0,o._)("th",{scope:"col",class:"px-6 py-3"}," Дата начала "),(0,o._)("th",{scope:"col",class:"px-6 py-3"}," Дата окончания ")])],-1),T={class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"},L={scope:"row",class:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white"},U={class:"px-6 py-4"},V={class:"flex justify-between"},N={key:0,"aria-hidden":"true",class:"flex-shrink-0 w-6 h-6 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white enable-background:new 0 0 24 24",fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},I=[(0,o._)("path",{d:"M16.53 11.06L15.47 10l-4.88 4.88-2.12-2.12-1.06 1.06L10.59 17l5.94-5.94zM19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11z"},null,-1)],H={key:1,"aria-hidden":"true",class:"flex-shrink-0 w-6 h-6 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white",fill:"currentColor",viewBox:"0 0 500 600",xmlns:"http://www.w3.org/2000/svg"},M=[(0,o._)("path",{d:"M 501.62 92.11 L 267.24 2.04 a 31.958 31.958 0 0 0 -22.47 0 L 10.38 92.11 A 16.001 16.001 0 0 0 0 107.09 V 144 c 0 8.84 7.16 16 16 16 h 480 c 8.84 0 16 -7.16 16 -16 v -36.91 c 0 -6.67 -4.14 -12.64 -10.38 -14.98 Z M 64 192 v 160 H 48 c -8.84 0 -16 7.16 -16 16 v 48 h 448 v -48 c 0 -8.84 -7.16 -16 -16 -16 h -16 V 192 h -64 v 160 h -96 V 192 h -64 v 160 h -96 V 192 H 64 Z m 432 256 H 16 c -8.84 0 -16 7.16 -16 16 v 32 c 0 8.84 7.16 16 16 16 h 480 c 8.84 0 16 -7.16 16 -16 v -32 c 0 -8.84 -7.16 -16 -16 -16 Z"},null,-1)],A={key:2,viewBox:"0 0 128 128",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",fill:"currentColor","aria-hidden":"true",class:"flex-shrink-0 w-6 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white"},B=[(0,o._)("path",{d:"M110.55 117.41L76.92 63.69l29.73-44.82c.45-.69.5-1.57.1-2.3a2.222 2.222 0 0 0-1.97-1.18H80.34c-.74 0-1.45.38-1.86 1L51.49 57.08V17.64c0-1.24-1.01-2.24-2.24-2.24h-21.9c-1.24 0-2.24 1-2.24 2.24V118.6c0 1.24 1 2.24 2.24 2.24h21.9c1.23 0 2.24-1 2.24-2.24V70.55l30.82 49.24c.41.65 1.13 1.05 1.9 1.05h24.44c.81 0 1.57-.44 1.96-1.16c.39-.71.37-1.58-.06-2.27z"},null,-1)],q={class:"px-6 py-4"},Z={class:"px-6 py-4"},X={class:"dark:text-gray-200 text-base"},Y={class:"dark:text-gray-400 text-ml"},Q={class:"px-6 py-4"},z={class:"px-6 py-4"},E={name:"ContentTable",props:["contents"],methods:{}};var K=n(3744);const W=(0,K.Z)(E,[["render",function(t,e,n,a,s,r){return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.kq)(' <div class="text-gray-300 p-2 border" v-for="content in contents">\r\n        {{content.name}}\r\n    </div> '),(0,o._)("div",D,[(0,o._)("table",P,[F,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.contents,(t=>((0,o.wg)(),(0,o.iD)("tr",T,[(0,o._)("th",L,(0,_.toDisplayString)(t.id),1),(0,o._)("td",U,[(0,o._)("div",V,["App\\Models\\Event"===t.history_contentable_type?((0,o.wg)(),(0,o.iD)("svg",N,I)):(0,o.kq)("v-if",!0),"App\\Models\\Sight"===t.history_contentable_type?((0,o.wg)(),(0,o.iD)("svg",H,M)):(0,o.kq)("v-if",!0),t.cult_id?((0,o.wg)(),(0,o.iD)("svg",A,B)):(0,o.kq)("v-if",!0)])]),(0,o._)("td",q,(0,_.toDisplayString)(t.name),1),(0,o._)("td",Z,[(0,o._)("h1",X,(0,_.toDisplayString)(t.user.id)+" / "+(0,_.toDisplayString)(t.user.name),1),(0,o._)("p",Y,(0,_.toDisplayString)(t.user.email),1)]),(0,o._)("td",Q,(0,_.toDisplayString)(t.date_start),1),(0,o._)("td",z,(0,_.toDisplayString)(t.date_end),1)])))),256))])])])],2112)}]]);var $=n(9963);const R={class:"border dark:bg-gray-800 bg-gray-200 border-gray-300 dark:border-gray-700 shadow rounded grid grid-cols-4 gap-6 p-6 dark:text-gray-300"},j={class:"flex border p-1 rounded-lg dark:bg-gray-800 dark:border-gray-700 border-gray-400/50"},O=["value"],G=(0,o._)("label",{"data-te-select-label-ref":""},"статусы",-1),J={class:"mb-[0.125rem] block min-h-[1.5rem] pl-7 border rounded-lg dark:bg-gray-800 dark:border-gray-700 border-gray-400/50"},tt=(0,o._)("label",{class:"inline-block pl-[0.15rem] mt-[0.4rem] hover:cursor-pointer",for:"checkboxDefault"}," Последний статус ",-1);var et=n(6618),nt=n(7145);const ot={name:"HistoryContentFilter",components:{VueTailwindDatepicker:n(946).Z},setup:()=>({destroy$:new y.xQ,formatter:{date:"YYYY-MM-DD hh:mm:ss",month:"MM"}}),data(){return{contentName:this.getContentName(),contentDate:{startDate:this.getContentDate().split("~")[0].slice(0,19).replace("T"," "),endDate:this.getContentDate().split("~")[1].slice(0,19).replace("T"," ")},contentSponsor:this.getContentSponsor(),contentSearchText:this.getContentText(),contentStatuses:this.getContentStatuses(),contentStatusLast:this.getContentStatusLast(),contentUser:this.getContentUser(),statuses:[],allStatuses:[]}},methods:{...(0,s.nv)(g,["setContentName","setContentDate","setContentSponsor","setContentText","setContentStatuses","setContentStatusLast","setContentUser","getContentName","getContentDate","getContentSponsor","getContentText","getContentStatuses","getContentStatusLast","getContentUser"]),...(0,s.nv)(et.e,["getStatuses"]),getAllStatuses(){this.getStatuses().pipe((0,b.U)((t=>{this.statuses=t.data.statuses})),(0,x.K)((t=>(console.log(t),(0,k.of)(S.E)))),(0,f.R)(this.destroy$)).subscribe()}},mounted(){this.getAllStatuses(),(0,nt.vN)({Select:nt.Ph},{allowReinits:!0})},watch:{contentName(t){(t.length>3||0==t)&&this.setContentName(t)},contentDate(t){this.setContentDate(t.startDate+"~"+t.endDate)},contentSponsor(t){(t.length>3||0==t)&&this.setContentSponsor(t)},contentSearchText(t){(t.length>3||0==t)&&this.setContentText(t)},contentStatuses(t){this.setContentStatuses(t)},contentStatusLast(t){this.setContentStatusLast(t)},contentUser(t){(t.length>3||0==t)&&this.setContentUser(t)}}},at=(0,K.Z)(ot,[["render",function(t,e,n,a,s,r){const c=(0,o.up)("VueTailwindDatepicker");return(0,o.wg)(),(0,o.iD)("div",R,[(0,o.wy)((0,o._)("input",{"data-te-input-wrapper-init":"","onUpdate:modelValue":e[0]||(e[0]=t=>s.contentName=t),type:"text",name:"name",id:"name",placeholder:"Название",class:"rounded-lg dark:bg-gray-800 dark:border-gray-700 border-gray-400/50"},null,512),[[$.vModelText,s.contentName]]),(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>s.contentSponsor=t),type:"text",name:"sponsor",id:"sponsor",placeholder:"Спонсор мероприятия",class:"rounded-lg dark:bg-gray-800 dark:border-gray-700 border-gray-400/50"},null,512),[[$.vModelText,s.contentSponsor]]),(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>s.contentSearchText=t),type:"text",name:"text",id:"text",placeholder:"Поиск по тексту",class:"rounded-lg dark:bg-gray-800 dark:border-gray-700 border-gray-400/50"},null,512),[[$.vModelText,s.contentSearchText]]),(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>s.contentUser=t),type:"text",name:"user",id:"user",placeholder:"Имя автора",class:"rounded-lg dark:bg-gray-800 dark:border-gray-700 border-gray-400/50"},null,512),[[$.vModelText,s.contentUser]]),(0,o.Wm)(c,{formatter:a.formatter,modelValue:s.contentDate,"onUpdate:modelValue":e[4]||(e[4]=t=>s.contentDate=t),placeholder:"Дата начала и конца"},null,8,["formatter","modelValue"]),(0,o._)("div",j,[(0,o._)("div",null,[(0,o.wy)((0,o._)("select",{class:"h-6","onUpdate:modelValue":e[5]||(e[5]=t=>s.contentStatuses=t),"data-te-select-init":"",multiple:""},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.statuses,(t=>((0,o.wg)(),(0,o.iD)("option",{value:t.id+" "},(0,_.toDisplayString)(t.name),9,O)))),256))],512),[[$.vModelSelect,s.contentStatuses]]),G])]),(0,o._)("div",J,[(0,o.wy)((0,o._)("input",{"true-value":1,"false-value":0,class:"relative float-left -ml-[0.5rem] mr-[6px] mt-[0.5rem] h-[1.125rem] w-[1.125rem] appearance-none rounded-[0.25rem] border-[0.125rem] border-solid border-neutral-300 outline-none before:pointer-events-none before:absolute before:h-[0.875rem] before:w-[0.875rem] before:scale-0 before:rounded-full before:bg-transparent before:opacity-0 before:shadow-[0px_0px_0px_13px_transparent] before:content-[''] checked:border-primary checked:bg-primary checked:before:opacity-[0.16] checked:after:absolute checked:after:-mt-px checked:after:ml-[0.25rem] checked:after:block checked:after:h-[0.8125rem] checked:after:w-[0.375rem] checked:after:rotate-45 checked:after:border-[0.125rem] checked:after:border-l-0 checked:after:border-t-0 checked:after:border-solid checked:after:border-white checked:after:bg-transparent checked:after:content-[''] hover:cursor-pointer hover:before:opacity-[0.04] hover:before:shadow-[0px_0px_0px_13px_rgba(0,0,0,0.6)] focus:shadow-none focus:transition-[border-color_0.2s] focus:before:scale-100 focus:before:opacity-[0.12] focus:before:shadow-[0px_0px_0px_13px_rgba(0,0,0,0.6)] focus:before:transition-[box-shadow_0.2s,transform_0.2s] focus:after:absolute focus:after:z-[1] focus:after:block focus:after:h-[0.875rem] focus:after:w-[0.875rem] focus:after:rounded-[0.125rem] focus:after:content-[''] checked:focus:before:scale-100 checked:focus:before:shadow-[0px_0px_0px_13px_#3b71ca] checked:focus:before:transition-[box-shadow_0.2s,transform_0.2s] checked:focus:after:-mt-px checked:focus:after:ml-[0.25rem] checked:focus:after:h-[0.8125rem] checked:focus:after:w-[0.375rem] checked:focus:after:rotate-45 checked:focus:after:rounded-none checked:focus:after:border-[0.125rem] checked:focus:after:border-l-0 checked:focus:after:border-t-0 checked:focus:after:border-solid checked:focus:after:border-white checked:focus:after:bg-transparent dark:border-neutral-600 dark:checked:border-primary dark:checked:bg-primary dark:focus:before:shadow-[0px_0px_0px_13px_rgba(255,255,255,0.4)] dark:checked:focus:before:shadow-[0px_0px_0px_13px_#3b71ca]",type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=t=>s.contentStatusLast=t),id:"checkboxDefault"},null,512),[[$.vModelCheckbox,s.contentStatusLast]]),tt]),(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":e[7]||(e[7]=t=>s.contentUser=t),type:"text",name:"user",id:"user",placeholder:"Имя или почта автора",class:"rounded-lg dark:bg-gray-800 dark:border-gray-700 border-gray-400/50"},null,512),[[$.vModelText,s.contentUser]])])}]]),st={name:"HistoryContent",setup:()=>({destroy$:new y.xQ}),data:()=>({contents:null,total:0,nextPage:null,backPage:null}),components:{PaginateBar:v.Z,HistoryContentTable:W,HistoryContentFilter:at},computed:{...(0,s.rn)(g,["contentName","contentDate","contentSponsor","contentSearchText","contentStatuses","contentStatusLast","contentUser"])},methods:{...(0,s.nv)(r.f,["openLoaderFullPage","closeLoaderFullPage"]),...(0,s.nv)(d,["getContents"]),...(0,s.nv)(C.E,["showToast"]),...(0,s.nv)(u,["queryBuilder","setPageContentsForPageContents"]),viewBackPage(){this.setPageContentsForPageContents(this.backPage),this.getAllContents()},viewNextPage(){this.setPageContentsForPageContents(this.nextPage),this.getAllContents()},getAllContents(){this.openLoaderFullPage(),this.getContents(this.queryBuilder("contentsForPageContents")).pipe((0,h.X)(3),(0,p.g)(100),(0,m.b)((()=>{this.closeLoaderFullPage()})),(0,b.U)((t=>{console.log(t.data),t.data.historyContents.data.length?(this.contents=t.data.historyContents.data,this.nextPage=t.data.historyContents.next_cursor,this.backPage=t.data.historyContents.prev_cursor):(this.contents=null,this.showToast(w.info_content,"info"))})),(0,x.K)((t=>(console.log(t),this.closeLoaderFullPage(),399<t.response.status&&t.response.status<500&&this.showToast(w.warning_content+": "+t.message,"warning"),499<t.response.status&&t.response.status<600&&this.showToast(w.error_content+": "+t.message,"error"),(0,k.of)(S.E)))),(0,f.R)(this.destroy$)).subscribe()}},mounted(){this.getAllContents()},watch:{contentName(){this.getAllContents()},contentDate(){this.getAllContents()},contentSponsor(){this.getAllContents()},contentSearchText(){this.getAllContents()},contentStatuses(){this.getAllContents()},contentStatusLast(){this.getAllContents()},contentUser(){this.getAllContents()}}},rt=(0,K.Z)(st,[["render",function(t,e,n,s,r,c){const l=(0,o.up)("HistoryContentFilter"),d=(0,o.up)("HistoryContentTable"),i=(0,o.up)("PaginateBar");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(l,{class:"m-1"}),(0,o.Wm)(d,{contents:r.contents,class:"m-1"},null,8,["contents"]),r.nextPage||r.backPage?((0,o.wg)(),(0,o.iD)("div",a,[(0,o.Wm)(i,{nextPage:r.nextPage,backPage:r.backPage,onOnBackPage:e[0]||(e[0]=t=>c.viewBackPage()),onOnNextPage:e[1]||(e[1]=t=>c.viewNextPage()),class:"w-[70%]"},null,8,["nextPage","backPage"])])):(0,o.kq)("v-if",!0)],64)}]])},6618:(t,e,n)=>{n.d(e,{e:()=>r});var o=n(1257),a=n(9305),s=n(4072);const r=(0,a.Q_)("useStatus",{actions:{getStatuses:()=>(0,s.D)(o.Z.get("statuses"))}})}}]);