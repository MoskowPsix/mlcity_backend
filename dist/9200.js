"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9200],{9233:(e,t,r)=>{r.d(t,{X:()=>o});var a=r(655),s=r(5244),n=r(1016),o=function(e){function t(t){var r=e.call(this)||this;return r._value=t,r}return a.ZT(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype._subscribe=function(t){var r=e.prototype._subscribe.call(this,t);return r&&!r.closed&&t.next(this._value),r},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new n.N;return this._value},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(s.xQ)},7935:(e,t,r)=>{r.d(t,{Z:()=>i});var a=r(6252),s=r(9963);const n={class:"border border-gray-700 rounded-lg grid grid-cols-2 p-2 dark:bg-gray-800 bg-gray-50 mt-1"},o={class:"flex justify-evenly"},l={class:"flex justify-evenly"},c={name:"PaginateBar",props:["nextPage","backPage"],methods:{onBackPage(){this.$emit("onBackPage",this.backPage)},onNextPage(){this.$emit("onNextPage",this.nextPage)}}},i=(0,r(3744).Z)(c,[["render",function(e,t,r,c,i,g){return(0,a.wg)(),(0,a.iD)("div",n,[(0,a._)("div",o,[r.backPage?((0,a.wg)(),(0,a.iD)("button",{key:0,onClick:t[0]||(t[0]=(0,s.withModifiers)((e=>g.onBackPage()),["prevent"])),class:"mr-2 border bg-gray-200 text-gray-600 hover:bg-gray-300 hover:text-gray-700 border-gray-400 dark:hover:text-color-300/70 dark:text-gray-400/70 dark:border-gray-600 dark:bg-gray-900/40 dark:hover:bg-gray-700 pt-2 pb-2 pl-4 pr-4 shadow-lg rounded-lg"},"Назад")):(0,a.kq)("v-if",!0)]),(0,a._)("div",l,[r.nextPage?((0,a.wg)(),(0,a.iD)("button",{key:0,onClick:t[1]||(t[1]=(0,s.withModifiers)((e=>g.onNextPage()),["prevent"])),class:"border bg-gray-200 text-gray-600 hover:bg-gray-300 hover:text-gray-700 border-gray-400 dark:hover:text-color-300/70 dark:text-gray-400/70 dark:border-gray-600 dark:bg-gray-900/40 dark:hover:bg-gray-700 pt-2 pb-2 pl-4 pr-4 shadow-lg rounded-lg"},"Далее")):(0,a.kq)("v-if",!0)])])}]])},9200:(e,t,r)=>{r.r(t),r.d(t,{default:()=>G});var a=r(6252);const s={key:0,class:"flex justify-center m-1"};var n=r(9305),o=r(5238);class l{static error_events="При мероприятия произошла ошибка";static warning_events="Неудачная загрузка мероприятий";static info_events="Мероприятия не найдены"}var c=r(5960),i=r(9233);const g=(0,n.Q_)("useEventFilter",{state:()=>({eventName:new i.X(localStorage.getItem("eventNameFilter")||""),eventDate:new i.X(localStorage.getItem("eventDateFilter")||"~"),eventSponsor:new i.X(localStorage.getItem("eventSponsorFilter")||""),eventSearchText:new i.X(localStorage.getItem("eventTextFilter")||""),eventStatuses:new i.X(localStorage.getItem("eventStatusesFilter")||""),eventStatusLast:new i.X(localStorage.getItem("eventStatusLastFilter")||"true"),eventUser:new i.X(localStorage.getItem("eventUserFilter")||"")}),actions:{setEventName(e){localStorage.setItem("eventNameFilter",e),this.eventName=e},getEventName:()=>localStorage.getItem("eventNameFilter"),setEventDate(e){localStorage.setItem("eventDateFilter",e),this.eventDate=e},getEventDate(){return localStorage.getItem("eventDateFilter")||this.eventDate.getValue()},setEventSponsor(e){localStorage.setItem("eventSponsorFilter",e),this.eventSponsor=e},getEventSponsor:()=>localStorage.getItem("eventSponsorFilter"),setEventText(e){localStorage.setItem("eventTextFilter",e),this.eventSearchText=e},getEventText:()=>localStorage.getItem("eventTextFilter"),setEventStatuses(e){localStorage.setItem("eventStatusesFilter",e),this.eventStatuses=e},getEventStatuses:()=>localStorage.getItem("eventStatusesFilter"),setEventStatusLast(e){localStorage.setItem("eventStatusLastFilter",e),this.eventStatusLast=e},getEventStatusLast:()=>localStorage.getItem("eventStatusLastFilter"),setEventUser(e){localStorage.setItem("eventUserFilter",e),this.eventUser=e},getEventUser:()=>localStorage.getItem("eventUserFilter")}});var d=r(3048);const v=(0,n.Q_)("useEventQueryBuilder",{actions:{queryBuilder(e){return this.updateParams(),"eventsForPageEvents"===e&&this.eventsForPageEvents(),this.queryParams},updateParams(){this.name=g().getEventName(),this.date=g().getEventDate(),this.sponsor=g().getEventSponsor(),this.searchText=g().getEventText(),this.statuses=g().getEventStatuses(),this.statusLast=g().getEventStatusLast(),this.user=g().getEventUser()},eventsForPageEvents(){let e=[(new Date).toISOString(),(new Date).toISOString()];this.date&&(e=this.date.split("~")),this.queryParams={name:this.name,dateStart:e[0],dateEnd:e[1],sponsor:this.sponsor,searchText:this.searchText,statuses:this.statuses,statusesLast:this.statusLast,user:this.user,page:this.pageEventsForPageEvent}},setPageEventForPageEvents(e){this.pageEventsForPageEvent=e}},state:()=>({queryParams:[],name:null,date:null,sponsor:null,searchText:null,statuses:null,statusLast:null,user:null,pageEventsForPageEvent:null})});var u=r(5709),h=r(486),p=r(1558),b=r(5244),m=r(1075),x=r(5631),f=r(6722),y=r(7935),k=r(9963),w=r(3577);const E={class:"relative z-10 overflow-x-auto border border-gray-300 dark:border-gray-700 dark:border-gra rounded-lg"},S={class:"border border-gray-300 dark:border-gray-700 rounded-lg w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400"},_=(0,a._)("thead",{class:"border border-gray-300 dark:border-gray-700 rounded-lg text-xs text-gray-700 uppercase bg-gray-200 dark:bg-gray-800 dark:text-gray-400"},[(0,a._)("tr",null,[(0,a._)("th",{scope:"col",class:"px-6 py-3"}," id "),(0,a._)("th",{scope:"col",class:"px-6 py-3"}," Тип "),(0,a._)("th",{scope:"col",class:"px-6 py-3"}," Имя "),(0,a._)("th",{scope:"col",class:"px-6 py-3"}," Автор "),(0,a._)("th",{scope:"col",class:"px-6 py-3"}," Дата начала "),(0,a._)("th",{scope:"col",class:"px-6 py-3"}," Дата окончания ")])],-1),P=["onClick"],D={scope:"row",class:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white"},F={class:"px-6 py-4"},T={class:"flex justify-between"},L={key:0,viewBox:"0 0 128 128",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",fill:"currentColor","aria-hidden":"true",class:"flex-shrink-0 w-6 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white"},U=[(0,a._)("path",{d:"M110.55 117.41L76.92 63.69l29.73-44.82c.45-.69.5-1.57.1-2.3a2.222 2.222 0 0 0-1.97-1.18H80.34c-.74 0-1.45.38-1.86 1L51.49 57.08V17.64c0-1.24-1.01-2.24-2.24-2.24h-21.9c-1.24 0-2.24 1-2.24 2.24V118.6c0 1.24 1 2.24 2.24 2.24h21.9c1.23 0 2.24-1 2.24-2.24V70.55l30.82 49.24c.41.65 1.13 1.05 1.9 1.05h24.44c.81 0 1.57-.44 1.96-1.16c.39-.71.37-1.58-.06-2.27z"},null,-1)],N={class:"px-6 py-4"},V={class:"px-6 py-4"},I={class:"dark:text-gray-200 text-base"},M={class:"dark:text-gray-400 text-ml"},B={class:"px-6 py-4"},A={class:"px-6 py-4"},Z={name:"EventTable",props:["events"],methods:{emitEvent(e){this.$emit("event",e)}}};var H=r(3744);const C=(0,H.Z)(Z,[["render",function(e,t,r,s,n,o){return(0,a.wg)(),(0,a.iD)("div",E,[(0,a._)("table",S,[_,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.events,(e=>((0,a.wg)(),(0,a.iD)("tr",{class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600",onClick:(0,k.withModifiers)((t=>o.emitEvent(e)),["prevent"])},[(0,a._)("th",D,(0,w.toDisplayString)(e.id),1),(0,a._)("td",F,[(0,a._)("div",T,[(0,a.kq)(' <svg v-if="event.history_contentable_type === \'App\\\\Models\\\\Event\'" aria-hidden="true" class="flex-shrink-0 w-6 h-6 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white enable-background:new 0 0 24 24" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\r\n                        <path d="M16.53 11.06L15.47 10l-4.88 4.88-2.12-2.12-1.06 1.06L10.59 17l5.94-5.94zM19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11z"></path></svg>\r\n                    \r\n                        <svg v-if="event.history_contentable_type === \'App\\\\Models\\\\Sight\'" aria-hidden="true" class="flex-shrink-0 w-6 h-6 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white" fill="currentColor" viewBox="0 0 500 600" xmlns="http://www.w3.org/2000/svg">\r\n                        <path d="M 501.62 92.11 L 267.24 2.04 a 31.958 31.958 0 0 0 -22.47 0 L 10.38 92.11 A 16.001 16.001 0 0 0 0 107.09 V 144 c 0 8.84 7.16 16 16 16 h 480 c 8.84 0 16 -7.16 16 -16 v -36.91 c 0 -6.67 -4.14 -12.64 -10.38 -14.98 Z M 64 192 v 160 H 48 c -8.84 0 -16 7.16 -16 16 v 48 h 448 v -48 c 0 -8.84 -7.16 -16 -16 -16 h -16 V 192 h -64 v 160 h -96 V 192 h -64 v 160 h -96 V 192 H 64 Z m 432 256 H 16 c -8.84 0 -16 7.16 -16 16 v 32 c 0 8.84 7.16 16 16 16 h 480 c 8.84 0 16 -7.16 16 -16 v -32 c 0 -8.84 -7.16 -16 -16 -16 Z"></path></svg> '),e.cult_id?((0,a.wg)(),(0,a.iD)("svg",L,U)):(0,a.kq)("v-if",!0)])]),(0,a._)("td",N,(0,w.toDisplayString)(e.name),1),(0,a._)("td",V,[(0,a._)("h1",I,(0,w.toDisplayString)(e.author.id)+" / "+(0,w.toDisplayString)(e.author.name),1),(0,a._)("p",M,(0,w.toDisplayString)(e.author.email),1)]),(0,a._)("td",B,(0,w.toDisplayString)(e.date_start),1),(0,a._)("td",A,(0,w.toDisplayString)(e.date_end),1)],8,P)))),256))])])])}]]),q={class:"border dark:bg-gray-800 bg-gray-200 border-gray-300 dark:border-gray-700 shadow rounded grid grid-cols-4 gap-6 p-6 dark:text-gray-300"},O={class:"flex border p-1 rounded-lg dark:bg-gray-800 dark:border-gray-700 border-gray-400/50"},Q=["value"],$=(0,a._)("label",{"data-te-select-label-ref":""},"статусы",-1),X={class:"mb-[0.125rem] block min-h-[1.5rem] pl-7 border rounded-lg dark:bg-gray-800 dark:border-gray-700 border-gray-400/50"},Y=(0,a._)("label",{class:"inline-block pl-[0.15rem] mt-[0.4rem] hover:cursor-pointer",for:"checkboxDefault"}," Последний статус ",-1);var z=r(6618),j=r(7145);const K={name:"EventFilter",setup:()=>({destroy$:new b.xQ,formatter:{date:"YYYY-MM-DD hh:mm:ss",month:"MM"}}),data(){return{eventName:this.getEventName(),eventSponsor:this.getEventSponsor(),eventText:this.getEventText(),eventDate:{startDate:this.getEventDate().split("~")[0].slice(0,19).replace("T"," "),endDate:this.getEventDate().split("~")[1].slice(0,19).replace("T"," ")},eventStatuses:this.getEventStatuses(),eventStatusLast:this.getEventStatusLast(),eventUser:this.getEventUser(),statuses:[],allStatuses:[]}},components:{VueTailwindDatepicker:r(946).Z},methods:{...(0,n.nv)(g,["setEventName","getEventName","setEventSponsor","getEventSponsor","getEventDate","setEventDate","setEventText","getEventText","setEventStatuses","getEventStatuses","setEventStatusLast","getEventStatusLast","setEventUser","getEventUser"]),...(0,n.nv)(z.e,["getStatuses"]),getAllStatuses(){this.getStatuses().pipe((0,u.U)((e=>{e.data.statuses.length?this.statuses=e.data.statuses:this.statuses=[]})),(0,h.K)((e=>(console.log(e),(0,m.of)(x.E)))),(0,p.R)(this.destroy$)).subscribe()}},mounted(){(0,j.vN)({Select:j.Ph},{allowReinits:!0}),this.getAllStatuses()},watch:{eventName(e){(e.length>3||0==e)&&this.setEventName(e)},eventSponsor(e){(e.length>3||0==e)&&this.setEventSponsor(e)},eventDate(e){this.setEventDate(e.startDate+"~"+e.endDate)},eventText(e){(e.length>3||0==e)&&this.setEventText(e)},eventStatuses(e){this.setEventStatuses(e)},eventStatusLast(e){this.setEventStatuses(e)},eventUser(e){(e.length>3||0==e)&&this.setEventUser(e)}}},W=(0,H.Z)(K,[["render",function(e,t,r,s,n,o){const l=(0,a.up)("VueTailwindDatepicker");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",q,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.eventName=e),type:"text",name:"name",id:"name",placeholder:"Название",class:"rounded-lg dark:bg-gray-800 dark:border-gray-700 border-gray-400/50"},null,512),[[k.vModelText,n.eventName]]),(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>n.eventSponsor=e),type:"text",name:"sponsor",id:"sponsor",placeholder:"Спонсор мероприятия",class:"rounded-lg dark:bg-gray-800 dark:border-gray-700 border-gray-400/50"},null,512),[[k.vModelText,n.eventSponsor]]),(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>n.eventText=e),type:"text",name:"text",id:"text",placeholder:"Поиск по тексту",class:"rounded-lg dark:bg-gray-800 dark:border-gray-700 border-gray-400/50"},null,512),[[k.vModelText,n.eventText]]),(0,a.Wm)(l,{modelValue:n.eventDate,"onUpdate:modelValue":t[3]||(t[3]=e=>n.eventDate=e),"start-from":new Date,placeholder:"Дата начала и конца"},null,8,["modelValue","start-from"]),(0,a._)("div",O,[(0,a._)("div",null,[(0,a.wy)((0,a._)("select",{class:"h-6","onUpdate:modelValue":t[4]||(t[4]=e=>n.eventStatuses=e),"data-te-select-init":""},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.statuses,(e=>((0,a.wg)(),(0,a.iD)("option",{value:e.name},(0,w.toDisplayString)(e.name),9,Q)))),256))],512),[[k.vModelSelect,n.eventStatuses]]),$])]),(0,a._)("div",X,[(0,a.wy)((0,a._)("input",{"true-value":1,"false-value":0,class:"relative float-left -ml-[0.5rem] mr-[6px] mt-[0.5rem] h-[1.125rem] w-[1.125rem] appearance-none rounded-[0.25rem] border-[0.125rem] border-solid border-neutral-300 outline-none before:pointer-events-none before:absolute before:h-[0.875rem] before:w-[0.875rem] before:scale-0 before:rounded-full before:bg-transparent before:opacity-0 before:shadow-[0px_0px_0px_13px_transparent] before:content-[''] checked:border-primary checked:bg-primary checked:before:opacity-[0.16] checked:after:absolute checked:after:-mt-px checked:after:ml-[0.25rem] checked:after:block checked:after:h-[0.8125rem] checked:after:w-[0.375rem] checked:after:rotate-45 checked:after:border-[0.125rem] checked:after:border-l-0 checked:after:border-t-0 checked:after:border-solid checked:after:border-white checked:after:bg-transparent checked:after:content-[''] hover:cursor-pointer hover:before:opacity-[0.04] hover:before:shadow-[0px_0px_0px_13px_rgba(0,0,0,0.6)] focus:shadow-none focus:transition-[border-color_0.2s] focus:before:scale-100 focus:before:opacity-[0.12] focus:before:shadow-[0px_0px_0px_13px_rgba(0,0,0,0.6)] focus:before:transition-[box-shadow_0.2s,transform_0.2s] focus:after:absolute focus:after:z-[1] focus:after:block focus:after:h-[0.875rem] focus:after:w-[0.875rem] focus:after:rounded-[0.125rem] focus:after:content-[''] checked:focus:before:scale-100 checked:focus:before:shadow-[0px_0px_0px_13px_#3b71ca] checked:focus:before:transition-[box-shadow_0.2s,transform_0.2s] checked:focus:after:-mt-px checked:focus:after:ml-[0.25rem] checked:focus:after:h-[0.8125rem] checked:focus:after:w-[0.375rem] checked:focus:after:rotate-45 checked:focus:after:rounded-none checked:focus:after:border-[0.125rem] checked:focus:after:border-l-0 checked:focus:after:border-t-0 checked:focus:after:border-solid checked:focus:after:border-white checked:focus:after:bg-transparent dark:border-neutral-600 dark:checked:border-primary dark:checked:bg-primary dark:focus:before:shadow-[0px_0px_0px_13px_rgba(255,255,255,0.4)] dark:checked:focus:before:shadow-[0px_0px_0px_13px_#3b71ca]",type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=e=>n.eventStatusLast=e),id:"checkboxDefault"},null,512),[[k.vModelCheckbox,n.eventStatusLast]]),Y]),(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>n.eventUser=e),type:"text",name:"user",id:"user",placeholder:"Имя или почта автора",class:"rounded-lg dark:bg-gray-800 dark:border-gray-700 border-gray-400/50"},null,512),[[k.vModelText,n.eventUser]])])])}]]),R={name:"Users",setup:()=>({destroy$:new b.xQ}),data:()=>({events:[],nextPage:null,backPage:null}),components:{PaginateBar:y.Z,EventTable:C,EventFilter:W},computed:{...(0,n.rn)(g,["eventName","eventDate","eventSponsor","eventSearchText","eventStatuses","eventStatusLast","eventUser"])},methods:{...(0,n.nv)(o.E,["showToast"]),...(0,n.nv)(d.f,["openLoaderFullPage","closeLoaderFullPage"]),...(0,n.nv)(v,["queryBuilder","setPageEventForPageEvents"]),...(0,n.nv)(c.b,["getEvents"]),getAllEvent(){this.openLoaderFullPage(),this.getEvents(this.queryBuilder("eventsForPageEvents")).pipe((0,u.U)((e=>{this.closeLoaderFullPage(),console.log(e),e.data.events.data.length?this.events=e.data.events.data:this.showToast(l.info_events,"info"),this.nextPage=e.data.events.next_cursor,this.backPage=e.data.events.prev_cursor})),(0,h.K)((e=>(this.closeLoaderFullPage(),console.log(e),399<e.response.status&&e.response.status<500&&this.showToast(l.warning_events+": "+e.message,"warning"),499<e.response.status&&e.response.status<600&&this.showToast(l.error_events+": "+e.message,"error"),(0,m.of)(x.E)))),(0,p.R)(this.destroy$)).subscribe()},clickEvent(e){f.Z.push({path:`/event/${e.id}`})},viewBackPage(){this.setPageEventForPageEvents(this.backPage),this.getAllEvent()},viewNextPage(){this.setPageEventForPageEvents(this.nextPage),this.getAllEvent()}},mounted(){this.getAllEvent()},watch:{eventName(){this.getAllEvent()},eventDate(){this.getAllEvent()},eventSponsor(){this.getAllEvent()},eventSearchText(){this.getAllEvent()},eventStatuses(){this.getAllEvent()},eventStatusLast(){this.getAllEvent()},eventUser(){this.getAllEvent()}}},G=(0,H.Z)(R,[["render",function(e,t,r,n,o,l){const c=(0,a.up)("EventFilter"),i=(0,a.up)("EventTable"),g=(0,a.up)("PaginateBar");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(c,{class:"m-1"}),(0,a.Wm)(i,{events:o.events,onEvent:l.clickEvent,class:"m-1"},null,8,["events","onEvent"]),o.nextPage||o.backPage?((0,a.wg)(),(0,a.iD)("div",s,[(0,a.Wm)(g,{nextPage:o.nextPage,backPage:o.backPage,onOnBackPage:t[0]||(t[0]=e=>l.viewBackPage()),onOnNextPage:t[1]||(t[1]=e=>l.viewNextPage()),class:"w-[70%]"},null,8,["nextPage","backPage"])])):(0,a.kq)("v-if",!0)],64)}]])},5960:(e,t,r)=>{r.d(t,{b:()=>o});var a=r(1257),s=r(9305),n=r(4072);const o=(0,s.Q_)("useEvent",{actions:{getEvents:e=>(0,n.D)(a.Z.get("events",{params:e})),getEventForIds:e=>(0,n.D)(a.Z.get(`events/${e}`))}})},6618:(e,t,r)=>{r.d(t,{e:()=>o});var a=r(1257),s=r(9305),n=r(4072);const o=(0,s.Q_)("useStatus",{actions:{getStatuses:()=>(0,n.D)(a.Z.get("statuses"))}})},5238:(e,t,r)=>{r.d(t,{E:()=>n});var a=r(9305),s=r(3002);const n=(0,a.Q_)("useToast",{actions:{showToast(e,t){let r={position:"top-right",timeout:4984,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:1,showCloseButtonOnHover:!0,hideProgressBar:!0,closeButton:!1,icon:!0,rtl:!1};switch(t){case"success":(0,s.pm)().success(e,r);break;case"info":(0,s.pm)().info(e,r);break;case"warning":(0,s.pm)().warning(e,r);break;case"error":(0,s.pm)().error(e,r)}(0,s.pm)()}}})}}]);